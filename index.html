<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Untitled</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <link rel="stylesheet" href="css/base.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <div id="app">

    </div>
    <script src="js/vendor/react/react.js"></script>
    <script src="js/vendor/react/react-dom.js"></script>
   <script src="js/vendor/babel/browser.min.js"></script>
   <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/babel">
      'use strict';

      var prizes = {
        '46a40b9a' : {
          title : "Movie Ticket",
          img : "cineplex.png"
        },
        '9b615899' : {
          title : "Dinner with a friend",
          img : "restaurant.png"
        },
        '223783e2' : {
          title : "Chocolate Bunny",
          img : "chocolate-bunny.png"
        },
        '6d0d2889' : {
          title : "Booze",
          img : "booze.png"
        },
      };

      var App = React.createClass({
        getInitialState: function() {
          return {
              prize: {
                title: "",
                img:""
              },
              isSubmitted: false,
              hasError: false
          };
        },
        componentWillMount: function() {
          var prizeId = window.location.href.toString().split("id=")[1]
          var prize = prizes[prizeId];
          if(prize) {
            this.setState({prize: prize});
          }
        },
        submitForm: function() {
          var self = this;
          $.ajax({
            type: "POST",
            url: "https://maker.ifttt.com/trigger/foundegg/with/key/ePqrjk0BMgcKr8jRBEyNU7-oKB3Rta5DOM8-6e76z9K",
            data: {value1: self.state.prize.title, value2: $("#usr").val(), value3: $("#email").val()},
            success: function() {
                self.setState({isSubmitted: true})
            },
            error: function() {
     
              self.setState({hasError: true})
            },
            dataType: 'json'
          });
        },


        render: function() {
          var imagePath = "https://irenelibby.github.io/images/"
          return (
            <div className="page">
            <div className="header">
              <img src={imagePath + 'srca-sc-blue.png'}/>
            </div>
            <div className="container">
                  <p>If you are 1st to find this egg, you are eligible to win:</p>
                  <p className="title">{this.state.prize.title}</p>
                  <img src={imagePath + this.state.prize.img} />
                  <div className={this.state.isSubmitted || this.state.hasError ? 'hide' : ''}>
                    <p>Please enter full name & email below to enter:</p>
                    <div className="form-group">
                      <label>Name:</label>
                      <input type="text" className="form-control" id="usr" />
                    </div>
                    <div className="form-group">
                      <label>Email:</label>
                      <input type="email" className="form-control" id="email" />
                    </div>
                    <button className="pull-right btn btn-primary" onClick={this.submitForm}>Submit</button>
                  </div>
           
            </div>
            </div>
          );
        }
      });

      ReactDOM.render(<App />, document.getElementById('app'));
    </script>
  </body>
  </body>
</html>
